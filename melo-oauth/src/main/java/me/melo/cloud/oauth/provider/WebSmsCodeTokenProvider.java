package me.melo.cloud.oauth.provider;import me.melo.cloud.oauth.token.WebSmsCodeAuthenticationToken;import org.springframework.security.authentication.AuthenticationProvider;import org.springframework.security.core.Authentication;import org.springframework.security.core.AuthenticationException;import org.springframework.security.core.GrantedAuthority;import java.util.ArrayList;import java.util.List;public class WebSmsCodeTokenProvider implements AuthenticationProvider {    @Override    public Authentication authenticate(Authentication authentication) throws AuthenticationException {        Object principal = authentication.getPrincipal();        Object credentials = authentication.getCredentials();        List<GrantedAuthority> authorities = new ArrayList<>();        authorities.add((GrantedAuthority) () -> "resource:query");        WebSmsCodeAuthenticationToken webSmsCodeAuthenticationToken = new WebSmsCodeAuthenticationToken(principal, credentials, authorities);        return webSmsCodeAuthenticationToken;    }    @Override    public boolean supports(Class<?> authentication) {        return WebSmsCodeAuthenticationToken.class.isAssignableFrom(authentication);    }}