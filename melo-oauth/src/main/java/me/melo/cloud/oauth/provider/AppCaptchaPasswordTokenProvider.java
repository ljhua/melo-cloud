package me.melo.cloud.oauth.provider;import me.melo.cloud.oauth.token.AppCaptchaPasswordAuthenticationToken;import org.springframework.security.authentication.AuthenticationProvider;import org.springframework.security.core.Authentication;import org.springframework.security.core.AuthenticationException;import org.springframework.security.core.GrantedAuthority;import java.util.ArrayList;import java.util.List;public class AppCaptchaPasswordTokenProvider implements AuthenticationProvider {    @Override    public Authentication authenticate(Authentication authentication) throws AuthenticationException {        Object principal = authentication.getPrincipal();        Object credentials = authentication.getCredentials();        List<GrantedAuthority> authorities = new ArrayList<>();        authorities.add((GrantedAuthority) () -> "resource:query");        AppCaptchaPasswordAuthenticationToken appCaptchaPasswordAuthenticationToken = new AppCaptchaPasswordAuthenticationToken(principal, credentials, authorities);        return appCaptchaPasswordAuthenticationToken;    }    @Override    public boolean supports(Class<?> authentication) {        return AppCaptchaPasswordAuthenticationToken.class.isAssignableFrom(authentication);    }}