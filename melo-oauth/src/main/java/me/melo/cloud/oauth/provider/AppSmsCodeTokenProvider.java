package me.melo.cloud.oauth.provider;import me.melo.cloud.oauth.token.AppSmsCodeAuthenticationToken;import org.springframework.security.authentication.AuthenticationProvider;import org.springframework.security.core.Authentication;import org.springframework.security.core.AuthenticationException;import org.springframework.security.core.GrantedAuthority;import java.util.ArrayList;import java.util.List;public class AppSmsCodeTokenProvider implements AuthenticationProvider {    @Override    public Authentication authenticate(Authentication authentication) throws AuthenticationException {        Object principal = authentication.getPrincipal();        Object credentials = authentication.getCredentials();        List<GrantedAuthority> authorities = new ArrayList<>();        authorities.add((GrantedAuthority) () -> "resource:query");        AppSmsCodeAuthenticationToken appSmsCodeAuthenticationToken = new AppSmsCodeAuthenticationToken(principal, credentials, authorities);        return appSmsCodeAuthenticationToken;    }    @Override    public boolean supports(Class<?> authentication) {        return AppSmsCodeAuthenticationToken.class.isAssignableFrom(authentication);    }}